SELECT facid, extract(month from starttime) as month, SUM(slots) from cd.bookings WHERE starttime >= '2012-01-01' and starttime < '2013-01-01' GROUP BY rollup(facid, month) order by facid, month