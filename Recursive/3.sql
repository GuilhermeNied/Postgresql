with recursive recommenders(recommender, member) as ( select recommendedby, memid from cd.members union all select memb.recommendedby, rec.member from recommenders rec inner join cd.members memb on memb.memid = rec.recommender ) select rec.member member, rec.recommender, memb.firstname, memb.surname from recommenders rec inner join cd.members memb on rec.recommender = memb.memid where rec.member = 22 or rec.member = 12 order by rec.member asc, rec.recommender desc